V1302 – Unified Entry Flow + Ace Token Shop Route
Status: Approved
Scope: Locked
Drift: Not permitted
Version: 1302
Feature: Unified App Entry Flow + Shop Route + Corrected Navigation
Depends On:

V1100 – Landing Page & Home/Ace Token Hub

V1300 – Premium Landing Page (Marketing Edition)

V1301 – Public Demo Mode

1. Overview
V1302 resolves architectural drift introduced across V1100, V1300, and V1301 by unifying the app’s entry flow and establishing a single, authoritative routing structure.

This version introduces:

A single full‑game entry point (/app)

A single demo entry point (/game)

A single public entry point (/landing)

A single shop route (/shop)

A dispatcher root route (/) that decides where users go

Correct Ace Token pill behaviour

Correct Landing Page Ace Token Hub behaviour

Preservation of all existing UI, design, and code

This version does not introduce new gameplay, new economy systems, or new UI beyond routing fixes.

2. Problem Summary (From V1100 → V1301)
Across previous versions:

V1100
Introduced Landing Page + Home/Ace Token Hub, but did not define demo mode or shop routing.

V1300
Introduced a premium marketing landing page, but did not unify routing.

V1301
Introduced demo mode, but created two competing full‑game entry points:

/+page.svelte (full game)

/app/+page.svelte (full game)

This caused:

Landing page bypass

Shop inaccessible

Ace Token pill non‑functional

Returning users not detected

New users entering the wrong flow

V1302 resolves all of this.

3. Unified Routing Rules (Locked)
3.1 Root Route (/)
Acts as a dispatcher, not a game page.

Behaviour:
If user has save data → redirect to /app

If user has no save data → redirect to /landing

Contains no UI

This restores the intended flow from V1100 and V1300.

3.2 Landing Page (/landing)
Public marketing page.

Behaviour:
New users land here

Returning users never see it

“Play Now” → /game

“Install App” → PWA install

Ace Token Hub → /shop

This restores V1100 + V1300 behaviour.

3.3 Full Game (/app)
The only full game route.

Behaviour:
Loads saved progress

Shows Home/Ace Token button

Ace Token pill → /shop

If no save data → treat as new user:

Give “full bonus”

Show install banner

Disable saving until install

This merges the two 900‑line game pages into one.

3.4 Demo Game (/game)
As defined in V1301.

Behaviour:
No saving

All minigames unlocked

Install banner

Exit warning

Ace Token pill → /shop?demo=1

3.5 Shop (/shop)
New route.

Behaviour:
If demoMode === true → show locked shop

If full game → show shop grid

If accessed from landing:

If PWA installed → full shop

If not installed → locked shop

This completes the Ace Token Hub loop from V1100.

4. Component & File Requirements
4.1 New Files
Code
src/routes/shop/+page.svelte
src/routes/shop/+page.ts
4.2 Modified Files
Code
src/routes/+page.svelte      (dispatcher only)
src/routes/app/+page.svelte  (full game)
src/routes/landing/+page.svelte
src/lib/components/Header.svelte
4.3 Removed or Emptied Files
Code
src/routes/+page.svelte (remove game UI)
5. Behaviour Rules (Locked)
Ace Token Pill
In /app → /shop

In /game → /shop?demo=1

Always clickable

Landing Page Ace Token Hub
Entire section navigates to /shop

Dispatcher (/)
No UI

No game logic

No landing logic

Only redirects

Shop
No token sinks yet

No purchases

No economy changes

6. Drift Prevention
V1302 must not introduce:

New gameplay

New buildings

New minigames

New token sinks

New UI components

New stores

New animations

New economy logic

Any changes to V1100, V1300, or V1301 behaviour

This version only unifies routing and restores the intended architecture.

Any deviation requires V1303+.

7. Deliverables
V1302.md (this document)

/shop route

Corrected / dispatcher

Unified /app full game

Corrected landing → shop

Corrected Ace Token pill → shop

Removal of duplicate game entry point

No loss of existing UI or design