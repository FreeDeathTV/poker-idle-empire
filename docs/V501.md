V501.md ‚Äî Empire Slots Side‚ÄëGame (Final Spec, No Drift)
Status: Locked
Purpose: Add a casino‚Äëthemed slots side‚Äëgame that uses chip wagers with controlled risk, unlocks via Pro Dealers, and cannot distort the idle economy.

---

1. Scope

This spec defines the **Empire Slots** system:

- Unlock condition
- Wager rules
- Multipliers and probabilities
- Dual‚Äëmode (Low Stakes / High Stakes)
- UI contract
- Save fields
- Hard constraints

You must not change any other systems (buildings, boosts, prestige, reset, economy formulas).

---

2. Unlock Condition

Empire Slots unlocks when:

- `proDealersOwned >= 1`

Rules:

- Once unlocked, it stays unlocked permanently (across resets).
- No other unlock paths.
- On unlock, show a one‚Äëtime toast:
  - `"Your empire expands! Empire Slots unlocked üé∞"`

---

3. Access & Placement

After unlock, show a new button on the main screen:

- Label: `Empire Slots üé∞`
- Placement: directly under the main DEAL button (or equivalent primary action), above Ad Rewards.
- Tap opens the Empire Slots modal.

This button must never appear before `proDealersOwned >= 1`.

---

4. Core Mechanic

Empire Slots is a **chip wager ‚Üí multiplier ‚Üí payout** loop.

Flow:

1. Player opens Empire Slots.
2. Player selects mode: **Low Stakes** or **High Stakes**.
3. Player taps **SPIN**.
4. Game:
   - Calculates wager based on mode.
   - Deducts wager from current chips.
   - Randomly selects a multiplier using the probability table.
   - Pays out `wager √ó multiplier`.
   - Updates chip total.
5. Show result message and animation.

All outcomes are positive. The player never loses all chips.

---

5. Modes

5.1 Low Stakes Mode (‚Äú2‚ÄëChip Max Pull‚Äù)

- Wager: fixed `2` chips.
- Requirement: player must have `chips >= 2`.
- If `chips < 2`, SPIN is disabled with a clear message (e.g., ‚ÄúNeed 2 chips to spin.‚Äù).

Calculations:

- `wager = 2`
- `chipsAfterPayment = chips - wager`
- `finalChips = chipsAfterPayment + (wager * multiplier)`

Example:

- Start: `chips = 100`
- Wager: `2`
- After payment: `98`
- If multiplier = `10√ó`:
  - `finalChips = 98 + (2 * 10) = 118`

5.2 High Stakes Mode (‚Äú50% Chip Wager‚Äù)

- Wager: `50%` of current chips, floored.
- Requirement: player must have `chips >= 2` (to avoid 0 or 1 edge cases).
- If `chips < 2`, SPIN is disabled with a clear message.

Calculations:

- `wager = floor(chips * 0.5)`
- `chipsAfterPayment = chips - wager`
- `finalChips = chipsAfterPayment + (wager * multiplier)`

Example:

- Start: `chips = 100`
- Wager: `floor(100 * 0.5) = 50`
- After payment: `50`
- If multiplier = `2√ó`:
  - `finalChips = 50 + (50 * 2) = 150`
- If multiplier = `10√ó`:
  - `finalChips = 50 + (50 * 10) = 550`

---

6. Multiplier Table (Shared by Both Modes)

Empire Slots uses the same multiplier distribution in both modes.

Multipliers and probabilities:

- `2√ó` ‚Üí `70%`
- `3√ó` ‚Üí `20%`
- `4√ó` ‚Üí `7%`
- `5√ó` ‚Üí `2.5%`
- `10√ó` ‚Üí `0.5%`

Rules:

- Probabilities must sum to `100%`.
- Selection must be truly random within this distribution.
- No hidden modifiers, pity timers, or streak logic.

---

7. UI Contract

7.1 Modal Layout

Empire Slots modal must include:

- Title: `Empire Slots üé∞`
- Mode toggle:
  - `Low Stakes (2 chips)`
  - `High Stakes (50% of chips)`
- Wager summary:
  - For Low Stakes:
    - `You will risk: 2 chips`
    - `You will keep: chips - 2`
  - For High Stakes:
    - `You will risk: {wager}`
    - `You will keep: chips - wager`
- SPIN button:
  - Enabled only if `chips >= 2`.
- Result area:
  - Shows multiplier and net gain:
    - Example: `"You hit 4√ó! You won 16.8M chips!"`

7.2 Mode Toggle

- Two clearly labeled buttons or tabs.
- Exactly two states: `"low"` and `"high"`.
- Default mode:
  - On first open: `high`.
  - Afterwards: last used mode (persisted in memory and/or save).

7.3 Animations

- Reels spin for ~1.0‚Äì1.5 seconds.
- Reels stop sequentially.
- On result:
  - Multiplier pops (scale + brief glow).
- No excessive or continuous animations.

---

8. Cooldown

To keep the system simple and self‚Äëbalancing:

- **No mandatory cooldown is required** because:
  - Low Stakes is self‚Äëlimited by tiny gains.
  - High Stakes is self‚Äëlimited by 50% wager.

If a cooldown is implemented:

- It must be **global** to Empire Slots (applies to both modes).
- It must be **short** (e.g., 30‚Äì60 seconds).
- It must be purely time‚Äëbased (no ad skips, no monetisation hooks).
- It must be clearly displayed:
  - Example: `Next spin in: 00:27`.

---

9. Save/Load Rules

Allowed new save fields:

- `slotsUnlocked: boolean`
  - `true` once `proDealersOwned >= 1` has ever been reached.
- `slotsMode: "low" | "high"`
  - Last selected mode.
- `slotsNextAvailableAt: timestamp` (only if cooldown is implemented).

No other new save fields may be added for Empire Slots.

Empire Slots must not modify:

- `prestigePoints`
- `prestigeMultiplier`
- `signingBonusTotal`
- `escape history`
- Any reset‚Äërelated fields

---

10. Hard Constraints (No Drift)

You must not:

- Change building costs, cps, or boost formulas.
- Modify prestige, reset, or signing bonus logic.
- Add permanent multipliers or bonuses outside the chip gains defined here.
- Add ads, monetisation, or external hooks to Empire Slots.
- Add extra modes, extra multipliers, or extra reward types.
- Introduce negative outcomes (no ‚Äúlose all‚Äù, no ‚Äúlose X% more‚Äù).

You must:

- Implement exactly two modes: Low Stakes (2 chips) and High Stakes (50% chips).
- Use the multiplier table and probabilities exactly as defined.
- Ensure the player always retains at least some chips after a spin.
- Keep Empire Slots fully optional and non‚Äëblocking.
- Ensure Empire Slots cannot soft‚Äëlock or hard‚Äëlock progression.

---

11. Success Criteria

- Empire Slots unlocks exactly when the first Pro Dealer is purchased and never before.
- Both modes function correctly and use the same multiplier distribution.
- Players can never lose all chips from a single spin.
- Long‚Äëterm economy remains stable; Empire Slots feels exciting but not mandatory.
- No other systems (buildings, boosts, prestige, reset, debug) are affected or altered.
