üìò V2.1 ‚Äî Core Expansion Kit (Gameplay Systems)
This document contains everything the devs need to build V2.

Purpose:
Define the gameplay systems, math, unlocks, boosts, reset logic, and UI structure.

Contents:
1. New Buildings (5‚ÄëBuilding Expansion)
Pro Dealers

Card Shufflers

TDs

Sponsors

Building Expansion

Includes:

Unlock prereqs

Cost curves

Level caps

Soft cap at 300

Boost values (base + halved post‚Äë300)

Boost activation rules

Tree structure

Placement logic

UI indicators (active/locked/soft‚Äëcapped)

2. Boost Tree System
Full prereq chain

Boosts only activate when prereqs met

Multipliers flow upward to Poker Tables

Math formulas (A √ó B √ó sec √ó boosts)

Tree View + Accordion View rules

3. Reset System (Prestige Replacement)
Reset threshold (1e12 chips)

Prestige point gain

Multiplicative buff formula

First 3 faction switches free

After that: 50% buff penalty

Reset confirmation safety

Reset modal preview (buffs + signing bonus)

4. Syndicate System (Casino‚ÄëThemed Factions)
High Rollers Club

Asian Whale Cartel

Euro Elite Circle

Royal Flush Society

Each with:

Buff type

Badge/frame

Switching rules

5. Signing Bonus (Local Prestige Pool)
Logarithmic formula

Hard cap at +50%

Preview in reset modal

No backend dependency

6. UI Structure
Accordion default

Tree View toggle

Boost icons

Unlock hints

Soft‚Äëcap indicators

Reset modal layout

7. Delivery Sequence
Step‚Äëby‚Äëstep build order

QA checklist

Reset simulation plan

This is the implementation document ‚Äî the one devs follow line‚Äëby‚Äëline.

---

0. Preparation

- Ensure V1 codebase is stable
- Ensure all V2.1 building definitions exist in a planning file
- Ensure no V2.2 polish is mixed in (V2.1 is systems only)

1. Data Structures & Contracts (Foundation Layer)

Goal: Define all new buildings, prereqs, cost curves, caps, and boost values before touching UI or game logic.

1.1 Add new building definitions

- ProDealers
- CardShufflers
- TDs
- Sponsors
- BuildingExpansion

Each building must include:
- id
- name
- baseCost
- costMultiplier
- baseBoost
- softCapLevel = 300
- hardCapLevel = 1000
- prereqBuildingId
- prereqLevelRequired

1.2 Define the building tree

Hard‚Äëcode the prereq chain:
- PokerTables ‚Üí ProDealers (unlock at 10 Tables)
  ‚Üí CardShufflers (unlock at 10 Dealers)
  ‚Üí TDs (unlock at 10 Shufflers)
  ‚Üí Sponsors (unlock at 10 TDs)
  ‚Üí BuildingExpansion (unlock at 10 Sponsors)

1.3 Add unlock logic contract

- isUnlocked(buildingId, playerState) ‚Üí boolean

1.4 Add boost logic contract

- calculateBoost(buildingLevels, prereqsMet) ‚Üí number

2. Core Logic Implementation (Game Engine Layer)

Goal: Implement the actual math and progression rules.

2.1 Implement prereq checks
- If prereqs not met ‚Üí building is locked
- Boost does not activate
- UI shows lock icon

2.2 Implement cost curves
- cost = baseCost √ó (costMultiplier ^ level)

2.3 Implement level caps
- Hard cap: cannot exceed level 1000
- Soft cap: boost halved after level 300

2.4 Implement boost calculation
- If level ‚â§ 300: boost = level √ó baseBoost
- Else: boost = (300 √ó baseBoost) + ((level ‚àí 300) √ó (baseBoost √∑ 2))

2.5 Implement Poker Table earnings formula
- earnings = base √ó multiplier √ó seconds √ó (1 + totalBoost)

2.6 Implement building placement choice
- After Poker Tables, show all unlocked buildings
- Player chooses which to buy next
- No forced order

3. UI Implementation (Accordion + Tree View)

Goal: Build the V2.1 UI structure exactly as defined.

3.1 Accordion View (Default)

Sections:
- Core (Poker Tables)
- Boost Chain (Dealers ‚Üí Shufflers ‚Üí TDs ‚Üí Sponsors ‚Üí Expansion)
- Syndicate (Reset button only in V2.1)

Each building row must show:
- Icon
- Name
- Level
- Cost
- Income
- Boost indicator
- Lock indicator

3.2 Tree View Toggle

- Add a toggle button: [ Tree View ]
- Tree View shows hierarchy with level and boost, state (active/locked)

3.3 Soft‚Äëcap visual

- After level 300 ‚Üí faded arrow or ‚Äúreduced‚Äù tag

4. Reset System (Core Prestige Logic)

Goal: Implement the reset trigger and prestige point system (without factions yet).

4.1 Reset threshold
- If chips ‚â• 1e12 ‚Üí show reset button

4.2 Reset modal (V2.1 version)
- Shows current prestige points, new prestige points after reset, new multiplier
- Warning: ‚ÄúThis will reset all buildings and chips.‚Äù

4.3 Reset logic
- On confirm: add 1 prestige point; reset chips; reset all building levels; reset boosts; keep prestige multiplier

4.4 Multiplicative buff
- totalMultiplier = 1.1 ^ prestigePoints

5. Save/Load Updates

Goal: Ensure new systems persist correctly.

Add to save state:
- New building levels
- Unlock states
- Prestige points
- Total multiplier
- UI mode (accordion/tree)

6. QA & Simulation

Goal: Validate the economy and progression.

6.1 Add debug helpers
- Add chips; add building levels; force reset

6.2 Run 10 reset cycles
- Check boost scaling, soft cap behaviour, unlock timing, reset modal accuracy, UI responsiveness

6.3 Mobile testing
- Accordion tap accuracy; tree view readability; no horizontal scroll

7. Finalise V201

- Once all systems are stable: freeze V201, update documentation, mark V201 as ‚ÄúImplemented‚Äù in repo

